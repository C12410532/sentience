#summary Zen and the art of robot design

[http://unadorned.org/images/dandruff/newrobot_20050125.gif]

In order to be able to build useful maps for navigation and object recognition the system first needs to know a few things about the robot to which the cameras are attached.  The basic dimensions of the robot, position of the _head_ where the stereo cameras are fixed and total mass are all needed so that [OccupancyGrid occupancy grids] can be updated correctly, and so that short term predictions of the robots position and orientation - and therefore its localisation uncertainty - may be made.

=== Design Tips ===

  *  Many small robots are fitted with cameras, but these are usually low down at knee or ankle height and the view from this altitude is very uninteresting.  For robots to be able to really do anything useful in a home or office environment the cameras really need to be mounted at human eye level, so that desks, shelves and other surfaces of interest can be seen.  One good way to do this is to mount them on a conventional camera tripod.  Tripods are often lightweight, made from aluminium and plastic, and hold the cameras rigidly even as the robot moves around.  The vertical adjustment of the tripod may also be motorised if necessary to give a variety of viewing heights.

  *  A tilt mechanism allowing the cameras to look up towards the ceiling or down to the floor can be useful.  When the robot is resting its cameras can look around to check out the local vacinity and build up a more detailed occupancy grid model.  There are many low cost RC servo motor controllers available suitable for connection to a PC.

  *  Battery life is always a major consideration when building any kind of mobile robot.  Many research robots today needlessly lugg around heaps of metal, wasting battery power and reducing running times.  Think like an F1 racing car designer.  Ruthlessly hunt down and exterminate any dead weight in the system.  Where possible, use lightweight materials such as plastic, fibreglass or wood.  Just because the structure is light doesn't mean that it can't also be strong.  Anyone who has ever built R/C aircraft will know what I mean.

=== Get with the Program ===

Run the _Robot Designer_ program and enter the details.  From the *File* menu you may also import [CameraCalibration camera calibration] data to complete the inventory of settings needed to run Sentience.

When you're finished select *Save As* from the File menu and save the robot design file.  The file will look something like this:

{{{

<?xml version="1.0" encoding="ISO-8859-1"?>
<!--Sentience 3D Perception System-->
<Sentience>
  <Robot>
    <!--Name-->
    <Name>My Robot</Name>
    <!--Total mass in kilograms-->
    <TotalMassKilograms>1</TotalMassKilograms>
    <BodyDimensions>
      <!--Shape of the body-->
      <!--0 - square-->
      <!--1 - round-->
      <BodyShape>0</BodyShape>
      <!--Width of the body in millimetres-->
      <BodyWidthMillimetres>200</BodyWidthMillimetres>
      <!--Length of the body in millimetres-->
      <BodyLengthMillimetres>200</BodyLengthMillimetres>
      <!--Height of the body in millimetres-->
      <BodyHeightMillimetres>80</BodyHeightMillimetres>
    </BodyDimensions>
    <PropulsionSystem>
      <!--Propulsion type-->
      <PropulsionType>0</PropulsionType>
      <!--Distance between the wheels in millimetres-->
      <WheelBaseMillimetres>175</WheelBaseMillimetres>
      <!--How far from the front of the robot is the wheel base in millimetres-->
      <WheelBaseForwardMillimetres>25</WheelBaseForwardMillimetres>
      <!--Wheel diameter in millimetres-->
      <WheelDiameterMillimetres>70</WheelDiameterMillimetres>
      <!--Wheel Position feedback type-->
      <WheelPositionFeedbackType>0</WheelPositionFeedbackType>
      <!--Motor gear ratio-->
      <GearRatio>54</GearRatio>
      <!--Encoder counts per revolution-->
      <CountsPerRev>32</CountsPerRev>
      <!--Motor no load speed in RPM-->
      <MotorNoLoadSpeedRPM>175</MotorNoLoadSpeedRPM>
      <!--Motor torque rating in Kg/mm-->
      <MotorTorqueKgMm>80</MotorTorqueKgMm>
    </PropulsionSystem>
    <SensorPlatform>
      <!--Number of stereo cameras-->
      <NoOfStereoCameras>1</NoOfStereoCameras>
      <!--The type of head-->
      <HeadType>0</HeadType>
      <!--Size of the head in millimetres-->
      <HeadSizeMillimetres>50</HeadSizeMillimetres>
      <!--Shape of the head-->
      <HeadShape>0</HeadShape>
      <!--Offset of the head from the leftmost side of the robot in millimetres-->
      <HeadPositionLeftMillimetres>100</HeadPositionLeftMillimetres>
      <!--Offset of the head from the front of the robot in millimetres-->
      <HeadPositionForwardMillimetres>120</HeadPositionForwardMillimetres>
      <!--Height of the head above the ground in millimetres-->
      <HeadHeightMillimetres>1000</HeadHeightMillimetres>
      <!--Orientation of the cameras-->
      <CameraOrientation>0</CameraOrientation>
      <StereoCamera>
        <!--Name of the WDM software driver for the cameras-->
        <DriverName>Creative WebCam NX Ultra</DriverName>
        <!--Position and orientation of the camera relative to the robots head-->
        <PositionOrientation>
          <!--Position in millimetres-->
          <PositionMillimetres>0,0,0</PositionMillimetres>
          <!--Orientation in degrees-->
          <OrientationDegrees>0,0,-45</OrientationDegrees>
        </PositionOrientation>
        <!--Focal length in millimetres-->
        <FocalLengthMillimetres>5</FocalLengthMillimetres>
        <!--Camera baseline distance in millimetres-->
        <BaselineMillimetres>100</BaselineMillimetres>
        <!--Calibration Data-->
        <Calibration>
          <!--Image offsets in pixels due to small missalignment from parallel-->
          <Offsets>23.21169,-1</Offsets>
          <Camera>
            <!--Horizontal field of view of the camera in degrees-->
            <FieldOfViewDegrees>78</FieldOfViewDegrees>
            <!--Image dimensions in pixels-->
            <ImageDimensions>320,240</ImageDimensions>
            <!--The centre of distortion in pixels-->
            <CentreOfDistortion>157,112</CentreOfDistortion>
            <!--Polynomial coefficients used to describe the camera lens distortion-->
            <DistortionCoefficients>0,1.231268,0.0002229516</DistortionCoefficients>
            <!--Scaling factor-->
            <Scale>0.8125</Scale>
            <!--Rotation of the image in degrees-->
            <RotationDegrees>-0.3941584</RotationDegrees>
            <!--The minimum RMS error between the distortion curve and plotted points-->
            <RMSerror>3.328376</RMSerror>
          </Camera>
          <Camera>
            <!--Horizontal field of view of the camera in degrees-->
            <FieldOfViewDegrees>78</FieldOfViewDegrees>
            <!--Image dimensions in pixels-->
            <ImageDimensions>320,240</ImageDimensions>
            <!--The centre of distortion in pixels-->
            <CentreOfDistortion>155,113</CentreOfDistortion>
            <!--Polynomial coefficients used to describe the camera lens distortion-->
            <DistortionCoefficients>0,1.15394,0.0006436906</DistortionCoefficients>
            <!--Scaling factor-->
            <Scale>0.8125</Scale>
            <!--Rotation of the image in degrees-->
            <RotationDegrees>-0.6620849</RotationDegrees>
            <!--The minimum RMS error between the distortion curve and plotted points-->
            <RMSerror>3.4475</RMSerror>
          </Camera>
        </Calibration>
      </StereoCamera>
      <InverseSensorModels>
        <!--Interval between models in pixels-->
        <SensorModelInterval>0.5</SensorModelInterval>
        <!--Model Data-->
        <RayModel>3.770809E-05,4.414452E-05,5.349952E-05,7.009857E-05,8.900894E-05,0.0001359203,0.0001655073,0.0001836874,0.0002292219,0.0003181205,0.000388257,0.0004839249,0.0005267026,0.0005860844,0.0008843323,0.0009787864,0.001101842,0.001235469,0.001375497,0.001919538,0.002069832,0.002174573,0.002456678,0.002905587,0.003451764,0.003780027,0.003913206,0.004156805,0.005257214,0.005664928,0.006022565,0.006260414,0.00648059,0.00830408,0.008479063,0.008674129,0.009076014,0.009854036,0.01129499,0.0116136,0.01171326,0.01200267,0.013576,0.01441398,0.01472791,0.01479663,0.0148544,0.01731085,0.01743325,0.01748962,0.01758735,0.01811596,0.01999676,0.01995732,0.01984733,0.01983193,0.02099638,0.02193592,0.02182019,0.02161744,0.02143108,0.02310487,0.02320839,0.02294529,0.02266344,0.02267298,0.02407009,0.02373098,0.02341676,0.02300536,0.02343225,0.02403443,0.02357062,0.02321613,0.02279646,0.02340507,0.02339957,0.02289651,0.02246999,0.02213749,0.02266628,0.02226695</RayModel>
        <RayModel>6.995991E-06,8.629519E-06,1.420396E-05,2.289443E-05,3.066057E-05,5.006038E-05,6.318447E-05,9.660405E-05,0.0001284275,0.0001853969,0.000230034,0.0003118955,0.0004216713,0.0004746968,0.0007275139,0.0008073919,0.001026284,0.001279188,0.001421436,0.001959953,0.002106207,0.002555578,0.002972937,0.003431391,0.004004045,0.00440121,0.005184104,0.005452401,0.00655923,0.006968687,0.007679391,0.008494686,0.008662653,0.01038253,0.01048212,0.0113913,0.01206076,0.01260925,0.01373557,0.01386985,0.01505322,0.01516744,0.01609731,0.01652608,0.01688253,0.0175877,0.01744904,0.01850334,0.01835695,0.01876954,0.01896395,0.01892013,0.0193204,0.01899659,0.01946667,0.01918339,0.0191181,0.01902629,0.01868653,0.01887865,0.01848484,0.01816894,0.01783407,0.01762456,0.01742724,0.0170566,0.01646472,0.01606504,0.0159831,0.01551647,0.01504413,0.01448836,0.01403343,0.01391809,0.01351756,0.01279123,0.01238185,0.01201869,0.01177188,0.01148909,0.01057166,0.01032226,0.01009785,0.009762469,0.009365954,0.008735565,0.008458729,0.008285653,0.008015191,0.007469232,0.007108746,0.006848963,0.006683232,0.006518533,0.005847227,0.005684461,0.005515851,0.005335378,0.005123867,0.004635436,0.004507391,0.004388975,0.004237389,0.003946263,0.003678531,0.003547246</RayModel>
        <RayModel>7.098422E-06,1.200351E-05,1.951486E-05,4.25803E-05,6.131033E-05,0.0001032759,0.0001854329,0.0002449202,0.0004165124,0.0005845921,0.0007151117,0.001291926,0.00159172,0.001989064,0.002792356,0.003364311,0.004523888,0.00562393,0.006284471,0.007802634,0.009476733,0.01062589,0.01289192,0.01381276,0.01496496,0.01820607,0.01915775,0.02060736,0.02206396,0.02295634,0.02551119,0.02625341,0.02661276,0.02775027,0.0283188,0.02895982,0.02929681,0.02909548,0.02902318,0.02885056,0.02845718,0.02796938,0.02738201,0.02679076,0.02539333,0.02467939,0.02399438,0.02298759,0.02189829,0.02039384,0.01942237,0.01877717,0.0178803,0.01621387,0.01520989,0.01428471,0.013673,0.01313366,0.01108097,0.01060957,0.01007899,0.009441291,0.008785961,0.0075127,0.007082089,0.006789625,0.006326221,0.005552563,0.004962294,0.004577381,0.004391223,0.004168405,0.003357989,0.003139379,0.002953795,0.002778336,0.002593611,0.00205703,0.001952783,0.001872831,0.001735363,0.001526321,0.001288778,0.001201608,0.001155262,0.00109326,0.0008758346,0.0007917108,0.0007444936,0.0007085752,0.0006738578,0.0005017577,0.0004822684,0.0004625654,0.0004337382,0.0003862936,0.0003099261,0.0002936952,0.0002836288,0.0002691541,0.0002184106,0.0001906961,0.0001802053,0.0001737338,0.0001678743,0.0001217791,0.0001165784,0.0001121355,0.0001069737,9.729413E-05,7.452962E-05,7.170255E-05,6.970957E-05,6.657777E-05,5.551228E-05,4.654058E-05,4.442618E-05,4.330915E-05,4.19799E-05,3.1337E-05,2.896132E-05</RayModel>
        <RayModel>0.0003899717,0.0007051802,0.001127377,0.001775488,0.002656079,0.003743226,0.005716773,0.007758419,0.01032296,0.01310339,0.01621062,0.01983673,0.02289264,0.02807709,0.03124282,0.03459006,0.03747154,0.03987402,0.04279665,0.04424944,0.0442837,0.04458163,0.04498418,0.04430381,0.04288723,0.03963569,0.03804654,0.03661005,0.03448687,0.03077312,0.02783316,0.02553453,0.02354622,0.02197919,0.01755626,0.01609732,0.01440798,0.01288806,0.01164361,0.008909957,0.008182934,0.007067556,0.006316449,0.005280326,0.004203203,0.00378734,0.003156214,0.002899698,0.002145652,0.001842388,0.00160101,0.00135575,0.001246211,0.0008258972,0.0007722674,0.0006410518,0.0005618526,0.0004712445,0.0003399937,0.0003171348,0.0002452201,0.0002304684,0.0001693723,0.0001371654,0.0001211397,9.848758E-05,9.421938E-05,5.799527E-05,5.489154E-05,4.563235E-05,3.94485E-05,3.43862E-05,2.288033E-05,2.211552E-05,1.69039E-05,1.596695E-05,1.212019E-05,9.249899E-06,8.538621E-06,6.666056E-06,6.556998E-06,4.187506E-06</RayModel>
        <RayModel>0.001103085,0.002141102,0.003865016,0.006442252,0.009902225,0.01477882,0.02079239,0.02827668,0.03479244,0.04135619,0.04942353,0.05665514,0.06311064,0.0618852,0.06350511,0.06463693,0.0643184,0.06243397,0.05100203,0.04787377,0.04452776,0.03899598,0.03328615,0.02593237,0.02187037,0.01920774,0.01593385,0.01164846,0.009217907,0.007201546,0.005969638,0.005007315,0.002947528,0.002472962,0.001976311,0.00147572,0.001168224,0.0007272479,0.000556905,0.0004591428,0.0003289462,0.0002312346,0.0001636037,0.0001108907,9.236603E-05,7.185373E-05,3.999734E-05,3.165065E-05,2.337235E-05,1.722531E-05</RayModel>
        <RayModel>0.001785274,0.003865474,0.007449557,0.01349849,0.02440613,0.0372325,0.04699441,0.06158495,0.07558861,0.0873804,0.0971649,0.08294366,0.08282432,0.07858655,0.07073521,0.05951677,0.04213152,0.03447036,0.02743826,0.02102078,0.01429633,0.009314572,0.006639265,0.004823574,0.00331522,0.001773636,0.001159695,0.0007920924,0.000528887,0.000342386,0.0001664194,0.000100909,6.695385E-05,4.338798E-05</RayModel>
        <RayModel>0.002138834,0.005603574,0.01482912,0.02633033,0.04776054,0.07070737,0.1004165,0.1239496,0.1120256,0.1127709,0.1045673,0.08940487,0.07008591,0.04141099,0.02964916,0.02034768,0.01287798,0.007303413,0.003565585,0.002027914,0.001154618,0.0006245265,0.000263846,0.0001213222,6.094121E-05</RayModel>
        <RayModel>0.002430728,0.008753732,0.02430855,0.05818076,0.08676597,0.1267477,0.1556118,0.1615934,0.1436471,0.08835015,0.06265609,0.04059744,0.02186203,0.01092179,0.004355282,0.001937196,0.0008176096,0.0003454656,0.0001146174</RayModel>
        <RayModel>0.002872808,0.01451053,0.04699545,0.102974,0.1494251,0.1894056,0.1921183,0.1488752,0.08538368,0.03867579,0.0180326,0.007229497,0.002690773,0.000623067,0.0001745331</RayModel>
        <RayModel>0.003961536,0.02618139,0.0762126,0.1628623,0.2292316,0.2339244,0.1690075,0.06280699,0.02506116,0.008156906,0.002063361,0.0004996534</RayModel>
        <RayModel>0.00516232,0.03386094,0.1259002,0.2690071,0.2942281,0.1872888,0.06090386,0.01869768,0.004208177,0.0006880778</RayModel>
        <RayModel>0.00655002,0.06313378,0.2483619,0.3501658,0.2197126,0.08758451,0.02116804,0.003070627</RayModel>
        <RayModel>0.008851712,0.09250075,0.3174146,0.3702913,0.1732281,0.03447326,0.00313328</RayModel>
        <RayModel>0.01005979,0.1537584,0.4637679,0.3057621,0.06164856,0.004802822</RayModel>
        <RayModel>0.01281592,0.222334,0.5094001,0.2318563,0.02302027</RayModel>
        <RayModel>0.02382422,0.3935826,0.4727896,0.1055819,0.004192172</RayModel>
        <RayModel>0.02897694,0.4453771,0.4814436,0.04387334</RayModel>
        <RayModel>0.04203195,0.5813895,0.3643203,0.01222259</RayModel>
        <RayModel>0.06634317,0.6993762,0.2318885</RayModel>
        <RayModel>0.07822642,0.7910506,0.1304453</RayModel>
        <RayModel>0.1204435,0.8136649,0.06586432</RayModel>
        <RayModel>0.1588454,0.820251</RayModel>
        <RayModel>0.2343931,0.7569893</RayModel>
        <RayModel>0.2615738,0.7362508</RayModel>
        <RayModel>0.3944343,0.6052192</RayModel>
        <RayModel>0.5040862,0.4958858</RayModel>
        <RayModel>0.5831851,0.416805</RayModel>
        <RayModel>1</RayModel>
        <RayModel>1</RayModel>
        <RayModel>1</RayModel>
        <RayModel>1</RayModel>
        <RayModel>1</RayModel>
        <RayModel>1</RayModel>
        <RayModel>1</RayModel>
        <RayModel>1</RayModel>
        <RayModel>1</RayModel>
        <RayModel>1</RayModel>
        <RayModel>1</RayModel>
        <RayModel>1</RayModel>
        <RayModel>1</RayModel>
        <RayModel>1</RayModel>
        <RayModel>1</RayModel>
      </InverseSensorModels>
    </SensorPlatform>
    <!--Inverse sensor model data-->
    <OccupancyGrid>
      <!--The number of scales used within the local grid-->
      <LocalGridLevels>1</LocalGridLevels>
      <!--Cubic dimension of the local grid in cells-->
      <LocalGridDimension>128</LocalGridDimension>
      <!--Size of each grid cell (voxel) in millimetres-->
      <LocalGridCellSizeMillimetres>100</LocalGridCellSizeMillimetres>
      <!--The distance which the robot must travel before new data is inserted into the grid during mapping-->
      <LocalGridIntervalMillimetres>200</LocalGridIntervalMillimetres>
      <!--An extra radius applied when localising within the grid, to make localisation rays wider-->
      <LocalGridLocalisationRadiusMillimetres>200</LocalGridLocalisationRadiusMillimetres>
      <!--When updating the grid map this is the maximum range within which cells will be updated-->
      <!--This prevents the system from being slowed down by the insertion of a lot of very long range rays-->
      <LocalGridMappingRangeMillimetres>2500</LocalGridMappingRangeMillimetres>
    </OccupancyGrid>
    <MotionModel>
      <!--The number of possible poses to maintain at any point in time-->
      <NoOfPoses>100</NoOfPoses>
      <!--A culling threshold in the range 1-100 below which low probability poses are exterminated-->
      <CullThreshold>75</CullThreshold>
      <!--The number of time steps after which a pose is considered to be mature-->
      <MaturationTimeSteps>2</MaturationTimeSteps>
      <!--Motion noise (standard deviations)-->
      <MotionNoise>0.04,0.04,5E-05,5E-05,1E-05,1E-05</MotionNoise>
    </MotionModel>
  </Robot>
</Sentience>

}}}